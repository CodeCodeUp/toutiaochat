# ä»Šæ—¥å¤´æ¡è‡ªåŠ¨å‘æ–‡ç³»ç»Ÿ - Claude é¡¹ç›®æ–‡æ¡£

## é¡¹ç›®æ¦‚è¿°

åŸºäº AI çš„ä»Šæ—¥å¤´æ¡è‡ªåŠ¨å‘æ–‡ç³»ç»Ÿï¼Œæ”¯æŒæ–‡ç« ç”Ÿæˆã€äººå·¥å®¡æ ¸ã€è‡ªåŠ¨å‘å¸ƒçš„å®Œæ•´å·¥ä½œæµã€‚

## æŠ€æœ¯æ ˆ

| å±‚çº§ | æŠ€æœ¯é€‰å‹ |
|------|----------|
| åç«¯æ¡†æ¶ | FastAPI + Python 3.11 |
| å‰ç«¯æ¡†æ¶ | Vue 3 + TypeScript + Element Plus |
| æ•°æ®åº“ | PostgreSQL 15 |
| ç¼“å­˜/é˜Ÿåˆ— | Redis 7 |
| æµè§ˆå™¨è‡ªåŠ¨åŒ– | Playwright (headless) |
| AIæ–‡ç« ç”Ÿæˆ | OpenAI GPT-4 |
| å›¾ç‰‡ç”Ÿæˆ | é¢„ç•™æ¥å£ (Stable Diffusion / DALL-E) |
| éƒ¨ç½² | Docker Compose |

## ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           Vue 3 å‰ç«¯                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ä»ªè¡¨ç›˜   â”‚ â”‚ æ–‡ç« ç®¡ç† â”‚ â”‚ è´¦å·ç®¡ç† â”‚ â”‚ ä»»åŠ¡é˜Ÿåˆ— â”‚ â”‚ ç³»ç»Ÿè®¾ç½® â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        FastAPI åç«¯                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                      API Gateway                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚       â”‚              â”‚              â”‚              â”‚                â”‚
â”‚       â–¼              â–¼              â–¼              â–¼                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚ æ–‡ç«     â”‚   â”‚ è´¦å·    â”‚   â”‚ ä»»åŠ¡    â”‚   â”‚ å‘å¸ƒ    â”‚            â”‚
â”‚  â”‚ Service â”‚   â”‚ Service â”‚   â”‚ Service â”‚   â”‚ Service â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚       â”‚              â”‚              â”‚              â”‚                â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                              â”‚                                      â”‚
â”‚                              â–¼                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    Core Services                             â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚   â”‚
â”‚  â”‚  â”‚ AI Writer â”‚  â”‚ Image Gen â”‚  â”‚ Publisher â”‚               â”‚   â”‚
â”‚  â”‚  â”‚ (GPT-4)   â”‚  â”‚ (é¢„ç•™)    â”‚  â”‚(Playwright)â”‚               â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â–¼             â–¼             â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚PostgreSQLâ”‚ â”‚  Redis   â”‚ â”‚ å¤´æ¡å¹³å° â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ç›®å½•ç»“æ„

```
toutiao-publisher/
â”œâ”€â”€ backend/                    # FastAPI åç«¯
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ api/               # API è·¯ç”±
â”‚   â”‚   â”‚   â”œâ”€â”€ v1/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ articles.py
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ accounts.py
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ tasks.py
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ settings.py
â”‚   â”‚   â”‚   â””â”€â”€ deps.py        # ä¾èµ–æ³¨å…¥
â”‚   â”‚   â”œâ”€â”€ core/              # æ ¸å¿ƒé…ç½®
â”‚   â”‚   â”‚   â”œâ”€â”€ config.py
â”‚   â”‚   â”‚   â”œâ”€â”€ security.py
â”‚   â”‚   â”‚   â””â”€â”€ exceptions.py
â”‚   â”‚   â”œâ”€â”€ models/            # æ•°æ®åº“æ¨¡å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ article.py
â”‚   â”‚   â”‚   â”œâ”€â”€ account.py
â”‚   â”‚   â”‚   â”œâ”€â”€ task.py
â”‚   â”‚   â”‚   â””â”€â”€ base.py
â”‚   â”‚   â”œâ”€â”€ schemas/           # Pydantic æ¨¡å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ article.py
â”‚   â”‚   â”‚   â”œâ”€â”€ account.py
â”‚   â”‚   â”‚   â””â”€â”€ task.py
â”‚   â”‚   â”œâ”€â”€ services/          # ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”‚   â”œâ”€â”€ ai_writer.py   # AI æ–‡ç« ç”Ÿæˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ image_gen.py   # å›¾ç‰‡ç”Ÿæˆ (é¢„ç•™)
â”‚   â”‚   â”‚   â”œâ”€â”€ publisher.py   # å¤´æ¡å‘å¸ƒ
â”‚   â”‚   â”‚   â””â”€â”€ task_queue.py  # ä»»åŠ¡é˜Ÿåˆ—
â”‚   â”‚   â”œâ”€â”€ crud/              # æ•°æ®åº“æ“ä½œ
â”‚   â”‚   â””â”€â”€ main.py            # åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ alembic/               # æ•°æ®åº“è¿ç§»
â”‚   â”œâ”€â”€ requirements.txt
â”‚   â””â”€â”€ Dockerfile
â”œâ”€â”€ frontend/                   # Vue 3 å‰ç«¯
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ api/               # API è°ƒç”¨
â”‚   â”‚   â”œâ”€â”€ components/        # é€šç”¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ views/             # é¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ Dashboard.vue
â”‚   â”‚   â”‚   â”œâ”€â”€ Articles.vue
â”‚   â”‚   â”‚   â”œâ”€â”€ Accounts.vue
â”‚   â”‚   â”‚   â”œâ”€â”€ Tasks.vue
â”‚   â”‚   â”‚   â””â”€â”€ Settings.vue
â”‚   â”‚   â”œâ”€â”€ stores/            # Pinia çŠ¶æ€
â”‚   â”‚   â”œâ”€â”€ router/
â”‚   â”‚   â””â”€â”€ App.vue
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ Dockerfile
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ .env.example
â”œâ”€â”€ CLAUDE.md                   # æœ¬æ–‡æ¡£
â””â”€â”€ README.md
```

## æ•°æ®åº“è®¾è®¡

### accounts (å¤´æ¡è´¦å·)
| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | UUID | ä¸»é”® |
| nickname | VARCHAR(100) | è´¦å·æ˜µç§° |
| uid | VARCHAR(50) | å¤´æ¡UID |
| platform | VARCHAR(20) | å¹³å° (å¤´æ¡å·/ç™¾å®¶å·ç­‰) |
| cookies | TEXT | ç™»å½•Cookie (åŠ å¯†å­˜å‚¨) |
| status | ENUM | active/inactive/expired |
| last_publish_at | TIMESTAMP | æœ€åå‘å¸ƒæ—¶é—´ |
| created_at | TIMESTAMP | åˆ›å»ºæ—¶é—´ |
| updated_at | TIMESTAMP | æ›´æ–°æ—¶é—´ |

### articles (æ–‡ç« )
| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | UUID | ä¸»é”® |
| title | VARCHAR(100) | æ–‡ç« æ ‡é¢˜ |
| content | TEXT | æ–‡ç« å†…å®¹ |
| original_topic | TEXT | åŸå§‹è¯é¢˜/ç´ æ |
| cover_url | VARCHAR(500) | å°é¢å›¾URL |
| images | JSONB | æ–‡ç« å›¾ç‰‡åˆ—è¡¨ |
| image_prompts | JSONB | å›¾ç‰‡ç”Ÿæˆæç¤ºè¯ |
| status | ENUM | draft/pending_review/approved/rejected/published/failed |
| account_id | UUID | å…³è”è´¦å· |
| category | VARCHAR(50) | æ–‡ç« åˆ†ç±» |
| ai_model | VARCHAR(50) | ä½¿ç”¨çš„AIæ¨¡å‹ |
| token_usage | INTEGER | Tokenæ¶ˆè€— |
| published_at | TIMESTAMP | å‘å¸ƒæ—¶é—´ |
| publish_url | VARCHAR(500) | å‘å¸ƒåçš„æ–‡ç« URL |
| reject_reason | TEXT | æ‹’ç»åŸå›  |
| created_at | TIMESTAMP | åˆ›å»ºæ—¶é—´ |
| updated_at | TIMESTAMP | æ›´æ–°æ—¶é—´ |

### tasks (ä»»åŠ¡é˜Ÿåˆ—)
| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | UUID | ä¸»é”® |
| type | ENUM | generate/humanize/image_gen/publish |
| status | ENUM | pending/running/completed/failed |
| article_id | UUID | å…³è”æ–‡ç«  |
| account_id | UUID | å…³è”è´¦å· |
| priority | INTEGER | ä¼˜å…ˆçº§ |
| retry_count | INTEGER | é‡è¯•æ¬¡æ•° |
| error_message | TEXT | é”™è¯¯ä¿¡æ¯ |
| started_at | TIMESTAMP | å¼€å§‹æ—¶é—´ |
| completed_at | TIMESTAMP | å®Œæˆæ—¶é—´ |
| created_at | TIMESTAMP | åˆ›å»ºæ—¶é—´ |

### settings (ç³»ç»Ÿè®¾ç½®)
| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| key | VARCHAR(100) | é…ç½®é”® |
| value | TEXT | é…ç½®å€¼ |
| description | VARCHAR(500) | è¯´æ˜ |

## æ–‡ç« çŠ¶æ€æµè½¬

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   draft     â”‚ è‰ç¨¿ (å¯ç¼–è¾‘)
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚ å‘å¸ƒ
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ publishing  â”‚ å‘å¸ƒä¸­
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
  â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
  â”‚         â”‚
å¤±è´¥       æˆåŠŸ
  â–¼         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   failed    â”‚   â”‚  published  â”‚ å·²å‘å¸ƒ
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ é‡è¯•
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ publishing  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## API æ¥å£è®¾è®¡

### æ–‡ç« ç®¡ç†
```
POST   /api/v1/articles              # åˆ›å»ºæ–‡ç«  (AIç”Ÿæˆ)
GET    /api/v1/articles              # æ–‡ç« åˆ—è¡¨
GET    /api/v1/articles/{id}         # æ–‡ç« è¯¦æƒ…
PUT    /api/v1/articles/{id}         # æ›´æ–°æ–‡ç«  (ä»…è‰ç¨¿å¯ç¼–è¾‘)
DELETE /api/v1/articles/{id}         # åˆ é™¤æ–‡ç« 
POST   /api/v1/articles/{id}/publish # å‘å¸ƒæ–‡ç« 
POST   /api/v1/articles/{id}/regenerate # é‡æ–°ç”Ÿæˆ
```

### è´¦å·ç®¡ç†
```
POST   /api/v1/accounts              # æ·»åŠ è´¦å·
GET    /api/v1/accounts              # è´¦å·åˆ—è¡¨
GET    /api/v1/accounts/{id}         # è´¦å·è¯¦æƒ…
PUT    /api/v1/accounts/{id}         # æ›´æ–°è´¦å·
DELETE /api/v1/accounts/{id}         # åˆ é™¤è´¦å·
POST   /api/v1/accounts/{id}/refresh # åˆ·æ–°Cookie
GET    /api/v1/accounts/{id}/status  # æ£€æŸ¥è´¦å·çŠ¶æ€
```

### ä»»åŠ¡ç®¡ç†
```
GET    /api/v1/tasks                 # ä»»åŠ¡åˆ—è¡¨
GET    /api/v1/tasks/{id}            # ä»»åŠ¡è¯¦æƒ…
POST   /api/v1/tasks/{id}/retry      # é‡è¯•ä»»åŠ¡
DELETE /api/v1/tasks/{id}            # å–æ¶ˆä»»åŠ¡
```

### ç³»ç»Ÿè®¾ç½®
```
GET    /api/v1/settings              # è·å–è®¾ç½®
PUT    /api/v1/settings              # æ›´æ–°è®¾ç½®
POST   /api/v1/settings/test-ai      # æµ‹è¯•AIè¿æ¥
POST   /api/v1/settings/test-image   # æµ‹è¯•å›¾ç‰‡ç”Ÿæˆ
```

## æ ¸å¿ƒæµç¨‹

### 1. æ–‡ç« ç”Ÿæˆæµç¨‹
```
ç”¨æˆ·è¾“å…¥è¯é¢˜/ç´ æ
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AI Writer       â”‚ â† GPT-4 ç”Ÿæˆæ–‡ç« 
â”‚ - ç”Ÿæˆæ ‡é¢˜      â”‚
â”‚ - ç”Ÿæˆæ­£æ–‡      â”‚
â”‚ - ç”Ÿæˆå›¾ç‰‡æç¤ºè¯â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Humanizer       â”‚ â† äºŒæ¬¡å¤„ç†é™AIå‘³ (å¯é€‰)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Image Generator â”‚ â† æ ¹æ®æç¤ºè¯ç”Ÿæˆå›¾ç‰‡ (é¢„ç•™)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
    ä¿å­˜ä¸ºè‰ç¨¿
```

### 2. å‘å¸ƒæµç¨‹
```
å®¡æ ¸é€šè¿‡çš„æ–‡ç« 
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åˆ›å»ºå‘å¸ƒä»»åŠ¡    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Playwright      â”‚
â”‚ - å¯åŠ¨æµè§ˆå™¨    â”‚
â”‚ - æ³¨å…¥Cookie    â”‚
â”‚ - å¡«å†™æ ‡é¢˜å†…å®¹  â”‚
â”‚ - ä¸Šä¼ å›¾ç‰‡      â”‚
â”‚ - ç‚¹å‡»å‘å¸ƒ      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
   æ›´æ–°æ–‡ç« çŠ¶æ€
```

## å¼€å‘è§„èŒƒ

### åç«¯è§„èŒƒ
- ä½¿ç”¨ async/await å¼‚æ­¥ç¼–ç¨‹
- æ‰€æœ‰æ•°æ®åº“æ“ä½œé€šè¿‡ CRUD å±‚
- ä¸šåŠ¡é€»è¾‘æ”¾åœ¨ Service å±‚
- ä½¿ç”¨ Pydantic åšæ•°æ®æ ¡éªŒ
- ç»Ÿä¸€å¼‚å¸¸å¤„ç†å’Œå“åº”æ ¼å¼
- æ—¥å¿—ä½¿ç”¨ structlog

### å‰ç«¯è§„èŒƒ
- ç»„ä»¶ä½¿ç”¨ Composition API
- çŠ¶æ€ç®¡ç†ä½¿ç”¨ Pinia
- API è°ƒç”¨ç»Ÿä¸€å°è£…
- ä½¿ç”¨ TypeScript ä¸¥æ ¼æ¨¡å¼

### Git è§„èŒƒ
- main: ç”Ÿäº§åˆ†æ”¯
- develop: å¼€å‘åˆ†æ”¯
- feature/*: åŠŸèƒ½åˆ†æ”¯
- fix/*: ä¿®å¤åˆ†æ”¯

## ç¯å¢ƒå˜é‡

```env
# æ•°æ®åº“
DATABASE_URL=postgresql://user:pass@localhost:5432/toutiao

# Redis
REDIS_URL=redis://localhost:6379/0

# OpenAI
OPENAI_API_KEY=sk-xxx
OPENAI_MODEL=gpt-4

# å›¾ç‰‡ç”Ÿæˆ (é¢„ç•™)
IMAGE_GEN_PROVIDER=none  # none/stable_diffusion/dalle
IMAGE_GEN_API_KEY=
IMAGE_GEN_API_URL=

# å®‰å…¨
SECRET_KEY=your-secret-key
JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=1440

# å‘å¸ƒé…ç½®
PUBLISH_INTERVAL_MINUTES=30  # å‘å¸ƒé—´éš”
MAX_RETRY_COUNT=3            # æœ€å¤§é‡è¯•æ¬¡æ•°
```

## å¼€å‘è¿›åº¦è¿½è¸ª

### Phase 1: åŸºç¡€æ¡†æ¶ âœ… å·²å®Œæˆ
- [x] åç«¯é¡¹ç›®åˆå§‹åŒ– (FastAPI + SQLAlchemy)
- [x] æ•°æ®åº“æ¨¡å‹è®¾è®¡ (Account, Article, Task)
- [x] åŸºç¡€ CRUD API (articles, accounts, tasks)
- [x] å‰ç«¯é¡¹ç›®åˆå§‹åŒ– (Vue 3 + TypeScript + Element Plus)
- [x] åŸºç¡€é¡µé¢æ¡†æ¶ (Dashboard, Articles, Accounts, Tasks, Settings)
- [x] Docker Compose é…ç½®

### Phase 2: æ ¸å¿ƒåŠŸèƒ½ ğŸš§ è¿›è¡Œä¸­
- [x] AI æ–‡ç« ç”ŸæˆæœåŠ¡ (ai_writer.py)
- [x] æ–‡ç« ç®¡ç†é¡µé¢ (Articles.vue)
- [x] è´¦å·ç®¡ç†åŠŸèƒ½ (Accounts.vue)
- [ ] Cookie è·å–æµç¨‹ (éœ€è¦å®ç°æµè§ˆå™¨ç™»å½•è·å–)
- [ ] æ•°æ®åº“è¿ç§»è„šæœ¬ (Alembic)
- [ ] ç”¨æˆ·è®¤è¯ (JWT)

### Phase 3: å‘å¸ƒåŠŸèƒ½
- [x] Playwright å‘å¸ƒæœåŠ¡åŸºç¡€æ¡†æ¶ (publisher.py)
- [ ] ä»»åŠ¡é˜Ÿåˆ—å®ç° (Celery/Redis)
- [ ] å‘å¸ƒçŠ¶æ€è¿½è¸ª
- [ ] å‘å¸ƒç»“æœå›è°ƒ

### Phase 4: å®Œå–„ä¼˜åŒ–
- [x] å›¾ç‰‡ç”Ÿæˆæ¥å£é¢„ç•™ (image_gen.py)
- [x] å»AIåŒ–å¤„ç† (humanize_article)
- [ ] å®šæ—¶ä»»åŠ¡
- [ ] æ•°æ®ç»Ÿè®¡ä»ªè¡¨ç›˜
- [ ] æ“ä½œæ—¥å¿—

## æ³¨æ„äº‹é¡¹

1. **Cookie å®‰å…¨**: ä½¿ç”¨ AES åŠ å¯†å­˜å‚¨
2. **å‘å¸ƒé¢‘ç‡**: æ§åˆ¶å‘å¸ƒé—´éš”ï¼Œé¿å…è§¦å‘é£æ§
3. **é”™è¯¯é‡è¯•**: å‘å¸ƒå¤±è´¥è‡ªåŠ¨é‡è¯•ï¼Œæœ€å¤š3æ¬¡
4. **æ—¥å¿—è®°å½•**: å®Œæ•´è®°å½•æ“ä½œæ—¥å¿—ä¾¿äºæ’æŸ¥
5. **XPath ç»´æŠ¤**: å¤´æ¡é¡µé¢æ›´æ–°æ—¶éœ€è¦åŠæ—¶æ›´æ–°é€‰æ‹©å™¨
